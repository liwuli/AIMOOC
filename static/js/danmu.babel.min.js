"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},_createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),CFCMdanmu=function(){function t(e){_classCallCheck(this,t),this.initVal(e)}return _createClass(t,[{key:"initVal",value:function(t){this.cfg={};var e={parentid:"liveplayer",id:"danmusub",danmupart:"danmupart",wid:854,hei:480,linehei:20,info:!1,intervalflag:!1,danmuappendflag:!0};_extends(this.cfg,e,t),this.initcommonVal()}},{key:"initcommonVal",value:function(){var t=this.cfg;this.parentobj=this.getid(t.parentid),this.danmupartobj=this.getid(t.danmupart),this.showobj=this.getid(t.id),this.showobjparent=this.getid(t.id).parentNode,this.showobjevent(),this.danmuevent()}},{key:"getid",value:function(t){return document.getElementById(t)}},{key:"showobjevent",value:function(){var t=this,e=this.cfg;this.showobjparent.onclick=function(){var n=parseInt(t.getStyle(t.showobj,"right"));e.info=[],t.danmupartobj.innerHTML="",n<=1?(t.showobj.style.right="13px",this.style.background="#3197fc",e.danmuappendflag=!0,t.danmuevent()):(t.showobj.style.right="1px",this.style.background="#606060",e.danmuappendflag=!1,clearInterval(e.intervalflag))}}},{key:"getStyle",value:function(t,e){return window.getComputedStyle?window.getComputedStyle(t,null)[e]:t.currentStyle[e]}},{key:"danmuevent",value:function(){var t=this.cfg,e=this;if(t.info){var n=(new Date).getTime();if(t.info.length>0){var i=Math.random(0,1).toFixed(2)*(t.hei-t.linehei),a=document.createElement("div");a.setAttribute("id",n),a.setAttribute("class","danmuinfo");var o=t.info[0];t.info.shift(),o.content=o.content.replace(/<(?!img)[^>]*>/g,""),o.content=o.content.replace(/\s+style="[^"]*"/gi,"");var r=location.protocol+"//"+location.hostname;o.content=o.content.replace(new RegExp(r,"g"),"");var l=0;if(null!=(o.content+"").toString().match(/(<img)/g)&&(l=(o.content+"").toString().match(/(<img)/g).length),38*l>=(o.content+"").toString().length)a.setAttribute("style","animation: leftright 8s linear 0s;top:"+i+"px;right:-"+25*l+"px;width:"+25*l+"px");else{var s=parseInt(14*(o.content+"").toString().length-38*l*14+14*l),c=Math.ceil(s/852);c<=1?c=8:c*=8,a.setAttribute("style","animation: leftright "+c+"s linear 0s;top:"+i+"px;right:-"+s+"px;width:"+s+"px")}a.innerHTML=o.content,e.danmupartobj.appendChild(a),a.addEventListener("animationend",function(){e.danmupartobj.removeChild(a)},!1)}}}}]),t}();
export function danmu (obj) {
  return new CFCMdanmu(obj)
}